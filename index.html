<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Material Barcode Scanner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Material Scanner</h1>
            <p>Select material and scan barcode for verification</p>
            <button id="admin-toggle-btn" class="admin-btn admin-login">ğŸ”‘ Admin Login</button>
        </div>
        
        <!-- Global error container -->
        <div id="error-container" class="error-container" aria-live="polite"></div>
        
        <div class="content">
            <div class="section" id="material-section">
                <h2>ğŸ“¦ Material Selection</h2>
                <label for="material-select">Select Material:</label>
                <select id="material-select" required aria-describedby="material-help">
                    <option value="">-- Select Material --</option>
                    <!-- Options will be populated by JavaScript -->
                </select>
                <div id="material-help" class="help-text">Choose a material to begin scanning</div>
                <div id="expected-barcode" style="display:none;">
                    Expected Barcode: <span id="expected-code"></span>
                </div>
            </div>

            <div class="section" id="scan-section" style="display:none;">
                <h2>ğŸ“± Barcode Scanner</h2>
                <label for="barcode-input">Scan Barcode:</label>
                <input 
                    id="barcode-input" 
                    name="barcode" 
                    inputmode="text" 
                    pattern="[a-zA-Z0-9]{3,20}" 
                    autocomplete="off" 
                    placeholder="Enter or scan barcode..." 
                    required
                    minlength="3"
                    maxlength="20"
                    aria-describedby="barcode-help validation-errors"
                />
                <div id="barcode-help" class="help-text">Enter letters and numbers only (3-20 characters)</div>
                <div id="validation-errors" class="validation-errors" style="display:none;" role="alert"></div>
                <button id="scan-btn" type="button" aria-describedby="scan-help">ğŸ” Scan</button>
                <div id="scan-help" class="help-text">Click to verify the barcode or press Enter</div>
            </div>

            <div id="result" aria-live="polite" role="status"></div>

            <div class="section">
                <h2>ğŸ“‹ Scan History</h2>

                <!-- Enhanced History Controls -->
                <div class="history-controls">
                    <div class="controls-row buttons-row">
                        <button id="export-excel" type="button">ğŸ“ˆ Export Excel</button>
                        <button id="analyze-history" type="button">ğŸ“Š Analyze</button>
                    </div>
                </div>

                <!-- Analytics Panel -->
                <div id="history-analytics" class="analytics-panel"></div>

                <!-- History List -->
                <ul id="scan-history" aria-label="Scan history list"></ul>
                <button id="load-more-history" type="button" style="display: none;">Load More</button>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section" style="display: none;">
                <h4>Material Management</h4>
                <div class="footer-material-controls">
                    <div class="footer-input-row">
                        <input 
                            id="add-material-name" 
                            type="text" 
                            placeholder="Material Name" 
                            maxlength="50"
                            required
                        >
                        <input 
                            id="add-material-barcode" 
                            type="text" 
                            placeholder="Barcode" 
                            pattern="[a-zA-Z0-9]{3,20}"
                            maxlength="20"
                            required
                        >
                    </div>
                    <div class="footer-button-row">
                        <button id="add-material-btn" type="button" class="footer-add-btn">â• Add Material</button>
                        <button id="delete-material-btn" type="button" class="footer-delete-btn">ğŸ—‘ï¸ Delete Selected</button>
                    </div>
                    <div id="material-validation" class="validation-message" style="display: none;"></div>
                </div>
            </div>
            
            <div class="footer-section" style="display: none;">
                <h4>Admin Actions</h4>
                <div class="footer-actions">
                    <button id="clear-history" type="button" class="footer-action-btn">
                        ğŸ—‘ï¸ Clear History
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div class="footer-bottom-content">
                <p>&copy; 2024 Material Scanner. Built with â¤ï¸ for efficient inventory management.</p>
                <div class="footer-stats">
                    <span id="footer-scan-count">Total Scans: 0</span>
                    <span id="footer-material-count">Materials: 3</span>
                </div>
            </div>
        </div>
    </footer>

    <audio id="success-sound" preload="auto" aria-hidden="true">
        <source src="success.mp3" type="audio/mpeg">
        <source src="success.wav" type="audio/wav">
    </audio>
    <audio id="error-sound" preload="auto" aria-hidden="true">
        <source src="error.mp3" type="audio/mpeg">
        <source src="error.wav" type="audio/wav">
    </audio>

    <script src="script.js"></script>
</body>
</html>
